<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Flasher | crDroid Redbull</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        crdroid: '#38b259',
                        darkbg: '#121212',
                        cardbg: '#1e1e1e'
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #121212;
            color: #ffffff;
            font-family: 'Inter', sans-serif;
        }
        .step-active { border-color: #38b259; }
        .step-active .step-icon { background-color: #38b259; color: #fff; }
        .step-inactive { border-color: #374151; opacity: 0.6; pointer-events: none; }
        .step-inactive .step-icon { background-color: #374151; color: #9ca3af; }
        .step-done { border-color: #38b259; }
        .step-done .step-icon { background-color: #166534; color: #38b259; border: 1px solid #38b259; }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Navbar -->
    <nav class="bg-cardbg border-b border-gray-800 py-4 sticky top-0 z-40 shadow-md">
        <div class="container mx-auto px-6 flex justify-between items-center">
            <a href="index.html" class="flex items-center gap-3 hover:opacity-80 transition-opacity">
                <i class="fa-brands fa-android text-crdroid text-3xl"></i>
                <span class="text-xl font-bold tracking-tight">crDroid <span class="text-crdroid">Redbull</span></span>
            </a>
            <div class="hidden md:flex space-x-6 text-sm font-medium items-center">
                <a href="index.html" class="hover:text-crdroid transition-colors">Home</a>
                <a href="flasher.html" class="text-crdroid font-bold">Web Flasher</a>
            </div>
        </div>
    </nav>

    <main class="flex-grow container mx-auto px-6 py-12 max-w-4xl">
        <div class="text-center mb-10">
            <h1 class="text-4xl font-extrabold mb-4">Web Flasher</h1>
            <p class="text-gray-400">Install crDroid directly from your browser. The tool will automatically download and flash the latest release for your device.</p>
        </div>

        <div id="browser-warning" class="hidden bg-red-900/20 border border-red-900 text-red-300 p-4 rounded-xl mb-8 shadow-lg flex items-start gap-4">
            <i class="fa-solid fa-triangle-exclamation text-2xl mt-1"></i>
            <div>
                <h4 class="font-bold mb-1">Browser Not Supported</h4>
                <p class="text-sm text-red-300/80">WebUSB is required for the flasher but is not supported by your current browser. Please use a Chromium-based browser like Google Chrome, Microsoft Edge, or Brave to use this tool.</p>
            </div>
        </div>

        <!-- Flasher Steps -->
        <div class="space-y-6" id="flasher-steps">
            
            <!-- Step 1: Connect -->
            <div id="step-1" class="step-active border-2 rounded-2xl p-6 bg-cardbg transition-all">
                <div class="flex items-center gap-4 mb-4">
                    <div class="step-icon w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg transition-colors">1</div>
                    <h2 class="text-2xl font-bold">Select Device & Connect</h2>
                </div>
                <div class="pl-14">
                    <p class="text-gray-400 mb-4">Select your device model, enable <strong>USB Debugging</strong>, and connect your phone. Only Chromium-based browsers (Chrome, Edge, Brave) are supported.</p>
                    
                    <div class="mb-4 max-w-sm">
                        <label class="block text-sm font-medium text-gray-300 mb-2">Target Device</label>
                        <select id="device-select" class="bg-gray-800 border border-gray-700 text-white text-sm rounded-lg focus:ring-crdroid focus:border-crdroid block w-full p-3">
                            <option value="" disabled selected>Select your device...</option>
                            <option value="bramble">Pixel 4a 5G (bramble)</option>
                            <option value="redfin">Pixel 5 (redfin)</option>
                            <option value="barbet">Pixel 5a (barbet)</option>
                        </select>
                    </div>

                    <button id="btn-connect" disabled class="bg-gray-800 text-gray-400 font-bold py-3 px-6 rounded-xl transition-colors flex items-center gap-2 cursor-not-allowed">
                        <i class="fa-brands fa-usb"></i> Connect via ADB
                    </button>
                    <p id="status-1" class="mt-3 text-sm font-mono text-crdroid hidden">Device connected!</p>
                </div>
            </div>

            <!-- Step 2: Flash Recovery -->
            <div id="step-2" class="step-inactive border-2 rounded-2xl p-6 bg-cardbg transition-all">
                <div class="flex items-center gap-4 mb-4">
                    <div class="step-icon w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg transition-colors">2</div>
                    <h2 class="text-2xl font-bold">Download & Flash Recovery</h2>
                </div>
                <div class="pl-14 space-y-4">
                    <p class="text-gray-400">We will download the latest recovery images (<code class="text-xs bg-gray-800 px-1 rounded">boot.img</code>, <code class="text-xs bg-gray-800 px-1 rounded">dtbo.img</code>, <code class="text-xs bg-gray-800 px-1 rounded">vendor_boot.img</code>) directly to your browser and flash them to the device.</p>
                    
                    <button id="btn-flash-recovery" class="bg-crdroid hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-colors flex items-center gap-2">
                        <i class="fa-solid fa-download"></i> Download & Flash Recovery
                    </button>
                    
                    <div id="progress-container-2" class="hidden space-y-2 mt-4">
                        <div class="flex justify-between text-xs text-gray-400">
                            <span id="dl-status-2">Downloading images...</span>
                            <span id="dl-percent-2">0%</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-2">
                            <div id="dl-bar-2" class="bg-blue-500 h-2 rounded-full w-0 transition-all duration-300"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Sideload ROM -->
            <div id="step-3" class="step-inactive border-2 rounded-2xl p-6 bg-cardbg transition-all">
                <div class="flex items-center gap-4 mb-4">
                    <div class="step-icon w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg transition-colors">3</div>
                    <h2 class="text-2xl font-bold">Download & Sideload crDroid</h2>
                </div>
                <div class="pl-14">
                    <div class="bg-gray-900/50 p-4 rounded-xl border border-gray-800 mb-4 text-sm">
                        <ol class="list-decimal pl-4 space-y-2 text-gray-300">
                            <li>On your phone, use volume keys to select <strong>Recovery Mode</strong> and press Power.</li>
                            <li>Once in crDroid Recovery, tap <strong>Apply update</strong> -> <strong>Apply from ADB</strong>.</li>
                            <li>Click the button below to stream the latest ROM directly to your device.</li>
                        </ol>
                    </div>

                    <button id="btn-sideload" class="bg-crdroid hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl transition-colors flex items-center gap-2">
                        <i class="fa-solid fa-upload"></i> Download & Sideload ROM
                    </button>
                    
                    <div id="progress-container-3" class="hidden space-y-2 mt-4">
                        <div class="flex justify-between text-xs text-gray-400">
                            <span id="dl-status-3">Fetching ROM...</span>
                            <span id="dl-percent-3">0%</span>
                        </div>
                        <div class="w-full bg-gray-800 rounded-full h-4 overflow-hidden border border-gray-700 relative">
                            <div id="dl-bar-3" class="bg-crdroid h-4 w-0 transition-all duration-300 absolute left-0 top-0"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <script src="flasher.js"></script>
</body>
</html>
